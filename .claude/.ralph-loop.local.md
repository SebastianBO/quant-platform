# Ralph Loop State

## Prompt
Perfect European company scraping for ALL companies public and private across Norway Sweden UK Denmark Finland Germany France Netherlands. Max out FREE APIs first. Target 100K companies with 50K financials.

## Config
- max_iterations: 30
- completion_promise: EU SCRAPING COMPLETE
- current_iteration: 5
- started_at: 2026-01-08T13:30:00Z

## Progress Log

### Iterations 1-4 - COMPLETE (Previous Session)
Built core infrastructure:
- Norwegian sync: Brreg (1.1M companies) + Regnskapsregisteret (financials) - FREE!
- Swedish sync: Yahoo v8 API (38 listed stocks) - FREE!
- UK sync: Companies House API (needs key)
- EU database schema (IFRS format)
- AI tools for EU company queries

### Iteration 5 - IN PROGRESS
**Comprehensive EU API Research Complete!**

Research findings from parallel subagents:

#### Denmark CVR (BEST FIND!)
- **Financials endpoint needs NO AUTH**: `http://distribution.virk.dk/offentliggoerelser/_search`
- Company data needs free email registration
- 2.2M+ Danish companies
- Elasticsearch API with full XBRL annual reports

#### Finland PRH (NO AUTH!)
- **Completely FREE API**: `https://avoindata.prh.fi/opendata-ytj-api/v3`
- No registration needed at all
- 300 requests/minute rate limit
- Full company data + XBRL financials available

#### France INSEE SIRENE
- FREE with OAuth2 registration
- 25M+ companies and establishments
- 30 requests/minute limit
- Requires consumer key/secret

#### Germany (Challenging)
- No official free API
- OffeneRegister.de: 5M+ companies (static dataset from 2017-2019)
- bundesAPI Python package for Bundesanzeiger scraping
- Most complex to implement

#### Netherlands KVK
- Financials FREE (no search without paid subscription)
- Need KVK numbers from bulk data
- 1 query/minute for financials

**Priority Implementation Order:**
1. ✅ Norway - Already working
2. ⏳ Denmark - NO AUTH financials endpoint!
3. ⏳ Finland - NO AUTH, easy integration
4. ⏳ France - Needs OAuth2 setup
5. ⏳ Germany - Bulk import from OffeneRegister
6. ⏳ Netherlands - Financials only (need KVK numbers)
7. ⏳ UK - Needs API key in Vercel

## FREE Data Sources Summary (Updated)
| Country | Source | API Key | Auth | Companies | Financials |
|---------|--------|---------|------|-----------|------------|
| Norway | Brreg + Regnskapsregisteret | **No** | None | 1.1M | Full |
| Denmark | CVR distribution.virk.dk | No (financials) | None/Email | 2.2M | Full XBRL |
| Finland | PRH avoindata.prh.fi | **No** | None | 600K+ | IXBRL |
| France | INSEE SIRENE | Yes (free) | OAuth2 | 25M | No |
| Germany | OffeneRegister.de | **No** | None | 5M | No |
| Netherlands | KVK opendata.kvk.nl | Yes | API Key | 2M+ | Full |
| UK | Companies House | Yes (free) | Basic | 4.5M | Bulk XBRL |
| Sweden | Yahoo v8 | **No** | None | 38 listed | Basic |

## Implementation Status
- [x] Norwegian company sync
- [x] Norwegian financials sync
- [x] Swedish stocks sync (Yahoo v8)
- [ ] Danish financials (NO AUTH - implementing now!)
- [ ] Finnish PRH (NO AUTH - implementing next!)
- [ ] French INSEE (needs OAuth2)
- [ ] German bulk import
- [ ] UK API key setup

## Next Steps
1. Implement Danish financials endpoint
2. Implement Finnish PRH endpoint
3. Test all endpoints
4. Deploy to Vercel with cron jobs
5. Scale Norwegian sync to 100K+ companies

## Status
ACTIVE - Iteration 5: Implementing Danish + Finnish integrations
